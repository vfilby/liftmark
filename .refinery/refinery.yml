# Refinery Configuration for LiftMark
#
# This file configures how the Refinery (Gas Town's merge queue processor)
# handles merges to the main branch.

# Version Bumping Configuration
version_bump:
  # Enable automatic version bumping on merge
  enabled: true

  # Version bump strategy: patch, minor, or major
  # - patch: Bug fixes and minor updates (1.0.0 -> 1.0.1)
  # - minor: New features, backward compatible (1.0.0 -> 1.1.0)
  # - major: Breaking changes (1.0.0 -> 2.0.0)
  strategy: patch

  # Script to run for version bumping
  # The script should:
  # 1. Bump version in package.json
  # 2. Update package-lock.json if present
  # 3. Stage files with git add
  # 4. Output the new version
  script: .refinery/bump-version.sh

  # Files that should be modified during version bump
  files:
    - package.json
    - package-lock.json

  # Commit message template for merge commits with version bump
  # Available variables:
  #   {pr.title}   - Pull request title
  #   {pr.number}  - Pull request number
  #   {pr.author}  - Pull request author
  #   {version}    - New version number
  #   {commits}    - List of commit messages in the PR
  commit_message: |
    Merge PR #{pr.number}: {pr.title}

    Version: {version}

    Co-Authored-By: {pr.author}

# Release Bead Configuration
release_beads:
  # Automatically create draft release beads after successful merge
  # This provides visibility that a release is ready to be created
  auto_create_draft: false

  # Track deployment status in beads
  # When enabled, GitHub Actions can update release bead status
  track_deployments: true

# Merge Configuration
merge:
  # Require CI to pass before merging
  require_ci: true

  # Require specific checks to pass
  required_checks:
    - CI

  # Use no-fast-forward merges to preserve PR history
  no_ff: true

  # Delete source branch after merge
  delete_branch: true

# Notifications
notifications:
  # Notify author when merge completes
  notify_author: true

  # Notify Witness when merge completes
  notify_witness: true
